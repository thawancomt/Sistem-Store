{% extends "base.html" %}

{% block title %}
    <title>Homepage</title>
{% endblock %}

{% block store_title %}
    <div>
        <h1 class="title-primary text-center">
            Gestão {{context.store_name | title }}
        </h1>
        
    </div>
{% endblock %}

{% block user_title %}
    
{% endblock %}

{% block content  %}

    {% for task in context.t %}


        <p>{{task.name}}</p>
        <p>{{ task.description }}</p>

     
    {% endfor %}

    <!-- Can´t edit if not admin -->
    {% with messages = get_flashed_messages() %}
            {% if messages %}
                {% for message in messages %}

                <div class="w-full flex justify-center">
                    <div class="w-5/6 h-48 border border-emerald-500 m-4">
                        <h1 class="m-4 text-white"> {{ message }}</h1>
                    </div>
                    
                </div>
                    
                {% endfor %}
            {% endif  %}
    {% endwith %}
    {# Admin section #}
    <div class="w-full flex justify-center">
        {% if not context['level'] == 'admin' %}
            <div class="container-primary">
                <div class="m-4">
                    <h1 class="title-primary text-yellow-400"> Adiministrator Section*</h1>
                    <p class="information-primary">This section is desnatited to the store managers, here you can acess users, stock and more</p>
                </div>
                <div class="ml-4 space-x-4  ">

                    
                    <a href="{{ url_for('users.home')}}" class="btn-primary hover:bg-red-700 hover:border-none w-3 h-8">
                        Access Users
                    </a>

                    <a href="{{url_for('articles.view')}}" class="btn-primary hover:bg-red-700 hover:border-none w-3 h-8">
                        Articles
                    </a>
                    <a href="{{url_for('production.home', store_id=current_user.store_id, date=today_date)}}" class="btn-primary hover:bg-red-700 hover:border-none w-3 h-8">
                        Production
                    </a>
                    <a href="{{url_for('store.home')}}" class="btn-primary hover:bg-red-700 hover:border-none w-3 h-8">Stores</a>

                    
                </div>
            </div>
        {% endif %}
    </div>
    
    <!-- Tasks Card -->
    <div class="w-full flex justify-center">
        <div class="container-primary">
            <div class="m-4">
                <h1 class="title-primary">Tasks to do</h1>
                <p class="information-primary">You can add some task to the store</p>

                <div class="space-y-4 mt-4">
                    {% if context['tasks'][0] %}
                        {% for task in context.tasks %}
                            <div class="flex justify-around container-primary w-full m-0 items-center
                            hover:border-emerald-800">
                                    <div class="w-8/12 p-2">
                                        
                                        {% if task.status | lower  == 'finished' %}
                                            <h4 class="title-primary text-red-500 mt-0 "> {{ task.name }}</h4>
                                        {% else %}
                                            <h4 class="title-primary text-white mt-0"> {{ task.name }}</h4>
                                            <p class=" text-white mt-0"> Created by: {{ task.creator.username }}</p>
                                        {% endif %}
                                        
                                        <h4 class="information-primary ml-4">{{task.description}}</h4>
                                    </div>

                                    <form action="{{ url_for('tasks.finish') }}" method="POST" class="w-2/12">
                                        <input type="text" name="task_id" value="{{task.id}}" hidden>
                                        <button type="submit" class="btn-primary m-0 w-[90%]">Finish</button>
                                    </form>

                                    <form action="{{ url_for('tasks.delete') }}" method="POST" class="w-2/12">
                                        <input type="text" name="task_id" value="{{task.id}}" hidden>
                                        <button type="submit" class="btn-primary m-0 w-[90%] hover:bg-red-800 border-none hover:border-none transition-all duration-300">Delete</button>
                                    </form>"
                            </div>
                        {% endfor %}
                    {% else  %}
                        <h1 class="sub-title-primary line-through">Empty to do list</h1>
                    {% endif %}
                    
                    <h1 class="title-primary text-xl">Concluded tasks</h1>
                    
                </div>
                

                <form action="{{ url_for('tasks.create') }}" method="POST" class="mt-4">
                    <label for="task_name" class="sub-title-primary">Add some task</label>
                    <input type="text" name="task_name" class="form-control-1">

                    <label for="task_to_send" class="sub-title-primary">description</label>
                    <input type="text" name="task_description" class="form-control-1">
                    <button type="submit" class="btn-primary"> Create task </button>
                </form>
                    
            </div>
            
        </div>
    </div>  
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>   
{% endblock %}
